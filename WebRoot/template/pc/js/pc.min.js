function changeAirportBusiness(){$(".airportBusiness").unbind().bind("click",function(){var t=$(this),i=t.attr("businessFlag");$.ajax({type:"POST",dataType:"text",url:"/airportPc_changeAirportBusiness.action",data:"flag="+i+"&random="+JM.randomNumber,success:function(t){$(".businessContent").html(t),queryBusinessInit()}})})}function queryBusinessInit(){$(".searchBusinessByKeyword").unbind().bind("click",function(){$("#businessType").val(),$("#keyword").val();$.ajax({type:"POST",dataType:"text",url:"/airportPc_queryBusiness.action",data:"businessType="+type+"&keyword="+keywpord,success:function(t){}})})}function queryFlightCompanyInit(){$(".searchFlightCompanyByKeyword").unbind().bind("click",function(){var t=$("#keyword"),i=$(this).attr("orderFlag");$.ajax({type:"POST",dataType:"text",url:"/airportPc_queryFlightCompany.action",data:"keyword="+JM.encodeByValue(t.val())+"&orderFlag="+i,success:function(t){$("#flightCompanySearchResult").html(t)}})})}function queryFlight(){$("#queryByFlight").bind("keyup",function(){queryFlightAjax()}).bind("keydown",function(){queryFlightAjax()}).bind("input",function(){queryFlightAjax()}).bind("keypress",function(){queryFlightAjax()}),$("#queryByDate").bind("change",function(){queryFlightAjax()}),$("#queryByTime").bind("change",function(){queryFlightAjax()}),$(".queryFlightByKeyword").unbind().bind("click",function(){var t=$("#flightFlag").val(),i=$("#keyword").val();$.ajax({type:"POST",dataType:"text",url:"/airportPc_queryFlightByKeyword.action",data:"keyword="+JM.encodeByValue(i)+"&flightFlag="+t,success:function(t){$("#flightSearchResult").html(t)}})}),$(".changeQueryWay").unbind().bind("click",function(){var t=$(this).attr("flag");$.ajax({type:"POST",dataType:"text",url:"/airportPc_changeFlightQueryWay.action",data:"flag="+t,success:function(t){$("#queryFlightWay").html(t)}})}),$(".queryFlightByNoAndDate").unbind().bind("click",function(){var t=$("#flightDate").val(),i=$("#flightNumber").val();return JM.isNull(i)?(JM.alert("请填写航班号~"),$("#flightNumber").focus(),!1):JM.isNull(t)?(JM.alert("请选择日期~"),$("#flightDate").focus(),!1):void $.ajax({type:"POST",dataType:"text",url:"/airportPc_queryFlightByNoAndDate.action",data:"flightNumber="+i+"&flightDate"+t,success:function(t){$("#queryFlightWay").html(t)}})}),$(".queryFlightByCity").unbind().bind("click",function(){var t=$("#setoutCity").val(),i=$("#reachCity").val();return JM.isNull(flightDate)?(JM.alert("请选择日期~"),$("#flightDate").focus(),!1):void $.ajax({type:"POST",dataType:"text",url:"/airportPc_queryFlightByCity.action",data:"setoutCity="+t+"&reachCity"+i+"&flightDate="+flightDate,success:function(t){$("#queryFlightWay").html(t)}})}),$("#searchFlight").unbind().bind("click",function(){queryFlightAjax()})}function queryFlightAjax(){$("#flightQueryResult").html("");var t=$("#flightFlag").val(),i=$("#queryByFlight").val(),e=$("#queryByDate").val(),a=$("#queryByTime").val();$.ajax({type:"POST",dataType:"text",url:"/airportPc_queryFlightByConditions.action",data:"flightFlag="+t+"&keyword="+i+"&flightDate="+e+"&flightTime="+a,success:function(t){$("#flightQueryResult").html(t)}})}function initValidForm(){var t=$("#pcForm");if(t&&!(t.size()<=0)){var i=!!JM.isNull(t.attr("ajaxPost"));t.Validform({tiptype:function(t,i,e){if(!i.obj.is("form")){var a=i.obj.siblings(".Validform_checktip");e(a,i.type),a.text(t)}},ajaxPost:i,beforeSubmit:function(i){var e=t.attr("alertConfirm");return!!JM.isNull(e)||!!confirm("是否确认提交？")},callback:function(e){function a(){var i=t.serialize(),e=$("#manageLink");JM.isNull(n)&&(n=e.attr("href")),n+=n.indexOf("?")<0?"?":"&",n+=i,t.attr("return")&&"false"==t.attr("return")?window.location.replace(n):window.location.href=n}if(1==i)if(e.status==JM.YES){var n=e.info.href;JM.isNull(n)?JM.alert(e.info,2e3,a):a()}else JM.alert(e.info),JM.flush()}})}}function sendSmsInit(){$(".sendSmsClass").unbind().bind("click",function(){var t=$(this);t.val("发验证码");var i=t.attr("sendType"),e=t.attr("elementId"),a=$("#"+e);return JM.isNullByJQuery(a)?(a.focus(),!1):void $.ajax({type:"POST",dataType:"json",url:"/sms.action",data:"sendType="+i+"&mobile="+JM.encode(a)+"&random="+JM.randomNumber,success:function(i){if(i.status==JM.YES){t.unbind();var e=60,a=setInterval(function(){e>0?$(".sendSmsClass").html(--e+"秒"):($(".sendSmsClass").html("发送验证码"),clearInterval(a))},1e3);window.setTimeout(sendSmsInit,6e4)}else i.status==JM.NO&&alert(i.info)}})})}jQuery(function(){initValidForm(),changeAirportBusiness(),queryBusinessInit(),queryFlightCompanyInit(),queryFlight(),sendSmsInit()});