function tipTypeFun(e,t,a){if(t.obj.is("form")){var n=t.obj.find("#msgdemo");a(n,t.type),n.text(e)}else{var n=t.obj.siblings(".Validform_checktip");a(n,t.type),n.text(e)}}function checkCommon(e){for(var t=$('input[name="'+e+'"]'),a=0;a<t.length;a++)for(var n=$(t[a]),i=a+1;i<t.length;i++){var o=$(t[i]);if(n.val()==o.val())return JM.alert(n.val()+"存在相同的值，请改正",2e3),!0}return!1}function checkidcard(){var e=$("#optiondiv").find("option:selected").text();"身份证"==e?($("#idCard").attr("dataType","sf"),$("#idCard").attr("errormsg","请输入正确的15位或18位证件号码")):($("#idCard").attr("dataType","*"),$("#idCard").attr("errormsg","请输入正确的证件号码"))}function setName(){$('input[name="name"]').change(function(){var e=$(this);e.attr("value",e.val())})}function openSaturation(){easyDialog.open({container:"saturation"})}function openWait(){easyDialog.open({container:"wait"}),setTimeout(function(){window.location="bjdjOrderTemplate_allOrder.action"},3e3)}function openNoCheckIn(){easyDialog.open({container:"warn_msg2"})}function openCheckInList(){easyDialog.open({container:"zj_ok"})}function openUpdateCheckIn(){easyDialog.close(),easyDialog.open({container:"warn_msg"})}function openFocusFlight(e){var t=[];$("input[id='flightNo']").each(function(e){t.push($(this).val())}),$.post("bjdjServiceCodeActivate_focusOnFlight.action",{flightNo:t},function(e){var t=$.parseJSON(e);$(".fucus_ok .c_content .line").children().remove();for(var a=0;a<t.info.length;a++){var n='<div class="x5 text-center fz24"><label><input type="hidden" value="'+t.info[a][1]+'"/><input name="radio2" type="radio" class="d_checkbox" />'+t.info[a][0]+"</label></div>";$(".fucus_ok .c_content .line").append(n)}easyDialog.open({container:"fucus_ok"})}),focusFlight=$(e)}function closeFocusFlight(){easyDialog.close();var e=$(".fucus_ok .c_content .line input:checked");focusFlight.attr("value",e.parent().text().trim()),focusFlight.parent().parent().next().children(".x8").children("input").val(e.prev().val()),focusFlight.parent().parent().next().children(".x8").children("input").attr("value",e.prev().val())}function openCommonTraveller(){$.post("commonTraveller_traverList.action",{},function(e){var t=$.parseJSON(e);$("#commonTraveller").find(".data").children().remove();for(var a=0;a<t.length;a++){var n='<div class="x5 text-center fz24"><label><input type="hidden" value="'+t[a][1]+'"/><input name="radio2" type="radio" class="d_checkbox" />'+t[a][0]+"</label></div>";$("#commonTraveller").find(".data").append(n)}easyDialog.open({container:"commonTraveller"})})}function closeCommonTraveller(){easyDialog.close();var e=$("#commonTraveller").find(".data").find("input:checked");$("#idCard").attr("value",e.prev().val())}function queryFlightByCertificate(){JM.alert("请求中..",0);var e=[];$('input[name="code"]').each(function(){e.push($(this).val())}),e.length>5&&JM.alert("最多只能同时激活5个人",2e3);var t=$("#idCard"),a=$("#items").find("input[name='cardValue']");if(!JM.isNull(a.val()))for(var n=0;n<a.length;n++){var i=$(a[n]);if(t.val()==i.val())return void JM.alert("此证件号码已提交过",3e3)}var o=[];$("input[name='flightNo']").each(function(e){o.push($(this).val())}),$.post("pcServiceCode_checkInFlight.action",{idCard:t.val(),flightNo:o},function(e){JM.alert("",1);var t=$.parseJSON(e);if(0==t.info.length)openNoCheckIn();else{$("#zj_ok").find(".data").children().remove();for(var a=0;a<t.info.length;a++){var n='<div class="x5 text-center fz24"><label><input name="radio1" type="radio" class="d_checkbox" />'+t.info[a]+"</label></div>";$("#zj_ok").find(".data").append(n)}openCheckInList()}})}function addActivateItem(){JM.alert("请求中..",0);var e="";$('input[name="code"]').each(function(){var t=$(this);e+=t.val(),e+=","});var t=$("#idCard");if(JM.isNull(t.val()))return void JM.alert("请输入身份证号",2e3);if(18!=t.val().length)return void JM.alert("请输入正确的身份证号",2e3);var a=[];$("input[id='flightNo']").each(function(e){a.push($(this).val())});var n=$("#select").find("option:selected").text();$.post("pcServiceCode_addByCertificate.action",{orderId:orderId,idCard:t.val(),code:e,codeId:codeId,cardType:n},function(e){setName(),JM.alert("",1,function(){$("#items").after(e)})})}function addBlankActivateItem(){easyDialog.close();var e=[];$('input[name="code"]').each(function(){e.push($(this).val())});var t=$("#idCard"),a=$(".input-auto").find("option:selected").text();$.post("pcServiceCode_addBlank.action",{orderId:orderId,idCard:t.val(),code:e.join(","),cardType:a},function(e){try{var t=$.parseJSON(e);return void("1"==t.info&&JM.alert("最多只能同时激活5个人",2e3))}catch(e){}$("#items").after(e),JM.scrollTo("body","input[name='name']:last",140),openUpdateCheckIn()})}function removeInput(e){var t=$(e),a=t.parent().parent(),n=a.prev(),i=n.prev(),o=i.prev(),r=o.prev();r.remove(),o.remove(),i.remove(),n.remove(),a.remove()}function newAdd(){var e=$("#items").html();$.post("bjdjServiceCodeActivate_saveActivateItem.action",{html:e},function(){window.location="pcOrder.action?type=newAdd"})}$(function(){code=$('input[name="code"]'),checkidcard(),$("#select").change(checkidcard),$("#cardForm").Validform({tiptype:tipTypeFun,ajaxPost:!0,beforeSubmit:function(e){return TuYou.Cookie.remove("flag"),queryFlightByCertificate(),!1}})});